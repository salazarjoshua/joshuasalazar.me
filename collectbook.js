const photocards =
  [
    // FORMULA OF LOVE
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "All Members (TWICE)",
      "img": "/assets/photocards/Formula of Love/fol-pob-00-twice.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Nayeon",
      "img": "/assets/photocards/Formula of Love/fol-pob-01-nayeon.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Jeongyeon",
      "img": "/assets/photocards/Formula of Love/fol-pob-02-jeongyeon.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Momo",
      "img": "/assets/photocards/Formula of Love/fol-pob-03-momo.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Sana",
      "img": "/assets/photocards/Formula of Love/fol-pob-04-sana.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Jihyo",
      "img": "/assets/photocards/Formula of Love/fol-pob-05-jihyo.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Mina",
      "img": "/assets/photocards/Formula of Love/fol-pob-06-mina.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Dahyun",
      "img": "/assets/photocards/Formula of Love/fol-pob-07-dahyun.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Chaeyoung",
      "img": "/assets/photocards/Formula of Love/fol-pob-08-chaeyoung.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Tzuyu",
      "img": "/assets/photocards/Formula of Love/fol-pob-09-tzuyu.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Momo",
      "img": "/assets/photocards/Formula of Love/fol-random-03-momo.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Jihyo",
      "img": "/assets/photocards/Formula of Love/fol-random-05-jihyo.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Mina",
      "img": "/assets/photocards/Formula of Love/fol-random-06-mina.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Tzuyu",
      "img": "/assets/photocards/Formula of Love/fol-random-09-tzuyu.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Chaeyoung",
      "img": "/assets/photocards/Formula of Love/fol-sc-08-chaeyoung.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Tzuyu",
      "img": "/assets/photocards/Formula of Love/fol-sc-09-tzuyu.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Sana",
      "img": "/assets/photocards/Formula of Love/fol-scratch-04-sana.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Formula of Love",
      "member": "Tzuyu",
      "img": "/assets/photocards/Formula of Love/fol-sc-09-tzuyu.jpg",
      "category": "want"
    },
    {
      "group": "Red Velvet",
      "album": "Formula of Love",
      "member": "Sana",
      "img": "/assets/photocards/Formula of Love/fol-scratch-04-sana.jpg",
      "category": "want"
    },
    // TASTE OF LOVE
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Chaeyoung",
      "img": "/assets/photocards/Taste of Love/tol-lenti-08-chaeyoung.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "All Members (TWICE)",
      "img": "/assets/photocards/Taste of Love/tol-pob-00-twice.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Nayeon",
      "img": "/assets/photocards/Taste of Love/tol-pob-01-nayeon.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Jeongyeon",
      "img": "/assets/photocards/Taste of Love/tol-pob-02-jeongyeon.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Momo",
      "img": "/assets/photocards/Taste of Love/tol-pob-03-momo.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Sana",
      "img": "/assets/photocards/Taste of Love/tol-pob-04-sana.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Jihyo",
      "img": "/assets/photocards/Taste of Love/tol-pob-05-jihyo.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Mina",
      "img": "/assets/photocards/Taste of Love/tol-pob-06-mina.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Dahyun",
      "img": "/assets/photocards/Taste of Love/tol-pob-07-dahyun.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Chaeyoung",
      "img": "/assets/photocards/Taste of Love/tol-pob-08-chaeyoung.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Tzuyu",
      "img": "/assets/photocards/Taste of Love/tol-pob-09-tzuyu.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Nayeon",
      "img": "/assets/photocards/Taste of Love/tol-random-01-nayeon-2.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Nayeon",
      "img": "/assets/photocards/Taste of Love/tol-random-01-nayeon.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Sana",
      "img": "/assets/photocards/Taste of Love/tol-random-04-sana-2.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Sana",
      "img": "/assets/photocards/Taste of Love/tol-random-04-sana.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Taste of Love",
      "member": "Chaeyoung",
      "img": "/assets/photocards/Taste of Love/tol-random-08-chaeyoung.jpg",
      "category": "have"
    },
    // FANCY YOU
    {
      "group": "TWICE",
      "album": "Fancy You",
      "member": "Chaeyoung",
      "img": "/assets/photocards/Fancy You/fy-mono-08-chaeyoung.jpg",
      "category": "have"
    },
    //PAGE TWO
    {
      "group": "TWICE",
      "album": "Page Two",
      "member": "Dahyun",
      "img": "/assets/photocards/Page Two/pt-lenti-07-dahyun.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Page Two",
      "member": "Jihyo",
      "img": "/assets/photocards/Page Two/pt-random-05-jihyo.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Page Two",
      "member": "Dahyun",
      "img": "/assets/photocards/Page Two/pt-random-07-dahyun.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "Page Two",
      "member": "Unit (TWICE)",
      "img": "/assets/photocards/Page Two/pt-unit-00-twice.jpg",
      "category": "have"
    },
    // THE STORY BEGINS
    {
      "group": "TWICE",
      "album": "The Story Begins",
      "member": "Nayeon",
      "img": "/assets/photocards/The Story Begins/tsb-random-01-nayeon.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "The Story Begins",
      "member": "Tzuyu",
      "img": "/assets/photocards/The Story Begins/tsb-random-09-tzuyu.jpg",
      "category": "have"
    },
    {
      "group": "TWICE",
      "album": "The Story Begins",
      "member": "Unit (TWICE)",
      "img": "/assets/photocards/The Story Begins/tsb-unit-00-twice.jpg",
      "category": "have"
    }
  ]


// Populate Dropdown
function populateDropdown(dropdown, key) {
  const unique = photocards.map(item => item[key]).filter((value, index, self) => self.indexOf(value) === index);

  for (var i = 0; i < unique.length; i++) {
    var data = unique[i];
    document.createElement("button");
    var dropdownIndex = `<li><button value="${data}" data-filter="${key}">${data}</button></li>\n`
    dropdown.innerHTML += dropdownIndex;
  }
}

const groupButtonContainers = document.querySelector('#groups');
const memberButtonContainers = document.querySelector('#members');
populateDropdown(groupButtonContainers, "group");
populateDropdown(memberButtonContainers, "member");


var groupButtons = Array.from(document.querySelectorAll('#groups button'));
var memberButtons = Array.from(document.querySelectorAll('#members button'));
const categoryButtons = Array.from(document.querySelectorAll('.btn--category'));


var dropdownButtons = document.querySelectorAll('.btn--dropdown');
var dropdownListButtons = document.querySelectorAll('.dropdown__list button');

// Show Dropdown
function handleDropDown() {
  const nextElement = this.nextElementSibling;
  nextElement.classList.toggle('collapse');
}

function handleDropDownList() {
  const dropdown = this.closest(".dropdown");
  const dropdownButton = dropdown.querySelector(".btn--dropdown");
  const dropdownButtonSpan = dropdown.querySelector("button span");
  dropdownButtonSpan.innerHTML = this.innerHTML;
  dropdownButton.focus();
}

// Change Active State
function changeActiveState() {
  const dropdownList = this.closest(".dropdown__list");
  const current = dropdownList.querySelector("button.selected");
  current.classList.remove("selected");
  this.classList.add("selected");
  dropdownList.classList.add("collapse");
}

function changeSelectedState() {
  if (document.querySelector('.btn--active') !== null) {
    document.querySelector('.btn--active').classList.remove('btn--active');
  }

  this.classList.add('btn--active');
}


dropdownButtons.forEach((button) => button.addEventListener('click', handleDropDown));
dropdownListButtons.forEach((button) => button.addEventListener('click', handleDropDownList));
dropdownListButtons.forEach((button) => button.addEventListener('click', changeActiveState));
categoryButtons.forEach((button) => button.addEventListener('click', changeSelectedState));

// Filter by Photocards

var filters = {
  member: '',
  group: '',
  category: 'have',
};

function handleChangeFilter() {
  filters[this.dataset.filter] = this.value;
  updateFilter();
}

categoryButtons.forEach((button) => button.addEventListener('click', handleChangeFilter));
groupButtons.forEach((button) => button.addEventListener('click', handleChangeFilter));
memberButtons.forEach((button) => button.addEventListener('click', handleChangeFilter));


function updateFilter() {
  filteredPhotocards = photocards.filter(item => {
    for (let key in filters) {
      if (!(item[key] === undefined || item[key] == filters[key]) && !(filters[key].length == 0)) {
        return false;
      }
    }
    return true;
  });

  console.table(filters)
  photocardsContainer.innerHTML = ""
  if (filteredPhotocards.length == 0) {
    photocardsContainer.innerHTML = `
    <div style="text-align: center;">
    <img src="/assets/avatar-sad.svg" alt="" style="display: inline-block;">
    <h3>Seems like I donâ€™t have that photocard :(</h3>
    <p class="text-sm">You can always buy me one though.</p>
    </div>
    `
  }
  const photocardsList = document.createElement('ul');
  photocardsList.classList.add('photocards');
  photocardsContainer.appendChild(photocardsList);
  photocardsList.innerHTML = filteredPhotocards.map(photocard => `<li><img src="${photocard.img}" alt="${photocard.group} - ${photocard.member}" class="photocard"></li>`).join("");

}

updateFilter();

